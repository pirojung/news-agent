name: Daily KT News Agent

on:
  schedule:
    # 한국 시간(KST) 아침 8시 = 협정 세계시(UTC) 밤 11시
    - cron: '12 23 * * *'
  workflow_dispatch: # 수동 실행 버튼 활성화

jobs:
  run-news-agent:
    runs-on: ubuntu-latest # 우분투 리눅스 서버 대여

    steps:
    - name: 저장소 코드 불러오기
      uses: actions/checkout@v3

    - name: 파이썬 환경 설정
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: 필요 라이브러리 설치
      run: |
        python -m pip install --upgrade pip
        pip install requests

    - name: 뉴스 에이전트 실행 및 메일 발송
      env: # GitHub Secrets 금고에서 꺼내오기
        NAVER_CLIENT_ID: ${{ secrets.NAVER_CLIENT_ID }}
        NAVER_CLIENT_SECRET: ${{ secrets.NAVER_CLIENT_SECRET }}
        EMAIL_APP_PWD: ${{ secrets.EMAIL_APP_PWD }}
      run: python piro_news_agent.py
